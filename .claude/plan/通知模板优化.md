# é€šçŸ¥æ¨¡æ¿ä¼˜åŒ–å®æ–½è®¡åˆ’

## é¡¹ç›®èƒŒæ™¯

ä¼˜åŒ– CCDD (Claude Code ä»»åŠ¡å®Œæˆæé†’ç³»ç»Ÿ) çš„é€šçŸ¥æ¨¡æ¿è®¾è®¡ï¼Œæå‡å¯è¯»æ€§å’Œä¿¡æ¯å±‚æ¬¡æ„Ÿã€‚

### å½“å‰é—®é¢˜
- ä½¿ç”¨è¿‡å¤š emoji (ğŸ¤–â°ğŸ’¡)ï¼Œè§†è§‰å¹²æ‰°è¾ƒå¤§
- ä¿¡æ¯æ’åˆ—ç¼ºå°‘å±‚æ¬¡ç»“æ„
- é”™è¯¯ä¿¡æ¯è¢«æˆªæ–­ï¼Œä¸ä¾¿äºå¿«é€Ÿåˆ¤æ–­
- æ—¶é—´æ ¼å¼å†—é•¿ï¼ˆå«å¹´ä»½å’Œç§’ï¼‰

### ä¼˜åŒ–ç›®æ ‡
1. å‡å°‘ emoji ä½¿ç”¨ï¼ˆæ¯æ¡æœ€å¤š 1-2 ä¸ªæˆ–ä½¿ç”¨çº¯ç¬¦å·ï¼‰
2. ä¿¡æ¯åˆ†å±‚æ¸…æ™°ï¼ˆæ ‡é¢˜ + æ­£æ–‡åˆ†å—ï¼‰
3. çŠ¶æ€æ ‡è¯†æ˜ç¡®ï¼ˆå®Œæˆ/å¤±è´¥/ç­‰å¾…è¾“å…¥ï¼‰
4. é”™è¯¯ä¿¡æ¯å®Œæ•´æ˜¾ç¤º
5. æ—¶é—´æ ¼å¼ç®€åŒ–ä¸º `MM-DD HH:mm`

---

## å®æ–½ç­–ç•¥

é‡‡ç”¨åˆ†é˜¶æ®µå®æ–½ï¼šå…ˆå¿«é€Ÿä¼˜åŒ–ï¼ˆæ–¹æ¡ˆ Aï¼‰ï¼Œå†ç»“æ„åŒ–é‡æ„ï¼ˆæ–¹æ¡ˆ Bï¼‰

---

## é˜¶æ®µ 1ï¼šå¿«é€Ÿä¼˜åŒ–ï¼ˆæ–¹æ¡ˆ Aï¼‰

### èŒƒå›´
ä»…ä¿®æ”¹é€šçŸ¥æ¨¡æ¿æ¸²æŸ“ï¼Œä¸æ”¹å˜ç°æœ‰æ•°æ®ç»“æ„ã€‚

### ä¿®æ”¹æ–‡ä»¶
- `feishu-notify.js`
- `telegram-notify.js`

### å®æ–½æ­¥éª¤

#### 1. æ·»åŠ å·¥å…·å‡½æ•°

**æ—¶é—´æ ¼å¼åŒ–å‡½æ•°**
```javascript
/**
 * æ ¼å¼åŒ–æ—¶é—´ä¸º MM-DD HH:mm
 * @param {Date} date - æ—¥æœŸå¯¹è±¡
 * @returns {string} æ ¼å¼åŒ–åçš„æ—¶é—´å­—ç¬¦ä¸²
 */
function formatTime(date) {
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    const hours = String(date.getHours()).padStart(2, '0');
    const minutes = String(date.getMinutes()).padStart(2, '0');
    return `${month}-${day} ${hours}:${minutes}`;
}
```

**çŠ¶æ€æ¨æ–­å‡½æ•°**
```javascript
/**
 * ä»ä»»åŠ¡ä¿¡æ¯æ¨æ–­çŠ¶æ€
 * @param {string} taskInfo - ä»»åŠ¡ä¿¡æ¯æ–‡æœ¬
 * @returns {string} çŠ¶æ€ï¼š'å®Œæˆ' | 'å¤±è´¥' | 'ç­‰å¾…è¾“å…¥'
 */
function inferStatusFromText(taskInfo) {
    const text = taskInfo.toLowerCase();

    // ç­‰å¾…è¾“å…¥å…³é”®è¯
    if (text.includes('permission') || text.includes('æƒé™') ||
        text.includes('idle') || text.includes('ç­‰å¾…') ||
        text.includes('elicitation') || text.includes('è¯·è¾“å…¥') ||
        text.includes('ç¡®è®¤')) {
        return 'ç­‰å¾…è¾“å…¥';
    }

    // å¤±è´¥å…³é”®è¯
    if (text.includes('error') || text.includes('å¤±è´¥') ||
        text.includes('exception') || text.includes('502') ||
        text.includes('bad gateway') || /http\s*5\d{2}/.test(text)) {
        return 'å¤±è´¥';
    }

    return 'å®Œæˆ';
}
```

#### 2. ä¼˜åŒ–é£ä¹¦é€šçŸ¥æ¨¡æ¿

**ä½ç½®**: `feishu-notify.js:174-181`

**ä¿®æ”¹å‰**:
```javascript
const title = projectName ? `${projectName}: ${taskInfo}` : taskInfo;
const content = `â° å®Œæˆæ—¶é—´ï¼š${timestamp}
ğŸ¯ æ‰‹æœºéœ‡åŠ¨ + æ‰‹ç¯éœ‡åŠ¨æé†’

ğŸ’¡ å¯ä»¥æŸ¥çœ‹æ‰§è¡Œç»“æœäº†ï¼`;
```

**ä¿®æ”¹å**:
```javascript
const status = inferStatusFromText(taskInfo);
const formattedTime = formatTime(new Date());
const title = projectName ? `ã€${status}ã€‘${projectName}` : `ã€${status}ã€‘ä»»åŠ¡é€šçŸ¥`;

let content = `â–  æ—¶é—´ï¼š${formattedTime}\n`;

if (status === 'å¤±è´¥') {
    content += `â–  é”™è¯¯ï¼š${taskInfo}\n`;
} else if (status === 'ç­‰å¾…è¾“å…¥') {
    content += `â–  åŸå› ï¼šéœ€è¦ä½ çš„è¾“å…¥\n`;
    content += `â–  è¯¦æƒ…ï¼š${taskInfo}`;
} else {
    content += `â–  çŠ¶æ€ï¼šä»»åŠ¡å·²å®Œæˆ\n`;
    content += `â–  è¯¦æƒ…ï¼š${taskInfo}`;
}
```

#### 3. ä¼˜åŒ– Telegram é€šçŸ¥æ¨¡æ¿

**ä½ç½®**: `telegram-notify.js:257-261`

**æ·»åŠ  HTML è½¬ä¹‰å‡½æ•°**:
```javascript
/**
 * HTML è½¬ä¹‰å‡½æ•°
 * @param {string} text - éœ€è¦è½¬ä¹‰çš„æ–‡æœ¬
 * @returns {string} è½¬ä¹‰åçš„æ–‡æœ¬
 */
function escapeHtml(text) {
    return text
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
}
```

**ä¿®æ”¹å‰**:
```javascript
const title = projectName ? `${projectName}: ${taskInfo}` : taskInfo;
const message = `ğŸ¤– <b>${title}</b>

â° å®Œæˆæ—¶é—´ï¼š${timestamp}

ğŸ’¡ å¯ä»¥æŸ¥çœ‹æ‰§è¡Œç»“æœäº†ï¼`;
```

**ä¿®æ”¹å**:
```javascript
const status = inferStatusFromText(taskInfo);
const formattedTime = formatTime(new Date(timestamp));
const title = projectName ? `ã€${status}ã€‘${projectName}` : `ã€${status}ã€‘ä»»åŠ¡é€šçŸ¥`;
const escapedTaskInfo = escapeHtml(taskInfo);

let message = `<b>${escapeHtml(title)}</b>\n`;
message += `â–  æ—¶é—´ï¼š${formattedTime}\n`;

if (status === 'å¤±è´¥') {
    message += `<b>é”™è¯¯</b>ï¼š${escapedTaskInfo}`;
} else if (status === 'ç­‰å¾…è¾“å…¥') {
    message += `â–  åŸå› ï¼šéœ€è¦ä½ çš„è¾“å…¥\n`;
    message += `â–  è¯¦æƒ…ï¼š${escapedTaskInfo}`;
} else {
    message += `â–  çŠ¶æ€ï¼šä»»åŠ¡å·²å®Œæˆ\n`;
    message += `â–  è¯¦æƒ…ï¼š${escapedTaskInfo}`;
}
```

### éªŒæ”¶æ ‡å‡†

**æˆåŠŸåœºæ™¯ç¤ºä¾‹**:
```
ã€å®Œæˆã€‘coriander_player
â–  æ—¶é—´ï¼š01-20 16:11
â–  çŠ¶æ€ï¼šä»»åŠ¡å·²å®Œæˆ
â–  è¯¦æƒ…ï¼šä»»åŠ¡å·²å®Œæˆ
```

**å¤±è´¥åœºæ™¯ç¤ºä¾‹**:
```
ã€å¤±è´¥ã€‘coriander_player
â–  æ—¶é—´ï¼š01-20 16:11
â–  é”™è¯¯ï¼šAPI Error: 502 {"error":"æ‰€æœ‰ 1 ä¸ª provider å‡å¤±è´¥ï¼Œæœ€åé”™è¯¯: {...}"}
```

**ç­‰å¾…è¾“å…¥åœºæ™¯ç¤ºä¾‹**:
```
ã€ç­‰å¾…è¾“å…¥ã€‘coriander_player
â–  æ—¶é—´ï¼š01-20 16:11
â–  åŸå› ï¼šéœ€è¦ä½ çš„è¾“å…¥
â–  è¯¦æƒ…ï¼špermission_prompt: éœ€è¦ç¡®è®¤æƒé™
```

### æµ‹è¯•æ–¹æ³•

```bash
# æµ‹è¯•é£ä¹¦é€šçŸ¥
node feishu-notify.js --message "ä»»åŠ¡å·²å®Œæˆ" --webhook "<url>"
node feishu-notify.js --message "HTTP 502 Bad Gateway" --webhook "<url>"
node feishu-notify.js --message "permission_prompt: éœ€è¦ç¡®è®¤" --webhook "<url>"

# æµ‹è¯• Telegram é€šçŸ¥
node telegram-notify.js --message "ä»»åŠ¡å·²å®Œæˆ"
node telegram-notify.js --message "HTTP 502 Bad Gateway"
node telegram-notify.js --message "permission_prompt: éœ€è¦ç¡®è®¤"
```

---

## é˜¶æ®µ 2ï¼šç»“æ„åŒ–é‡æ„ï¼ˆæ–¹æ¡ˆ Bï¼‰

### èŒƒå›´
å¼•å…¥ `NotificationPayload` ç»“æ„ï¼Œæ”¹é€ æ•´ä¸ªé€šçŸ¥é“¾è·¯ã€‚

### ä¿®æ”¹æ–‡ä»¶
- `notify-system.js`
- `notification-manager.js`
- `feishu-notify.js`
- `telegram-notify.js`

### æ•°æ®ç»“æ„è®¾è®¡

```javascript
/**
 * é€šçŸ¥è½½è·ç»“æ„
 * @typedef {Object} NotificationPayload
 * @property {string} projectName - é¡¹ç›®åç§°
 * @property {'å®Œæˆ'|'å¤±è´¥'|'ç­‰å¾…è¾“å…¥'} status - çŠ¶æ€
 * @property {string} time - å·²æ ¼å¼åŒ–æ—¶é—´ MM-DD HH:mm
 * @property {string} [summary] - ä»»åŠ¡æ‘˜è¦ï¼ˆéå¤±è´¥åœºæ™¯ï¼‰
 * @property {string} [error] - é”™è¯¯ä¿¡æ¯ï¼ˆå¤±è´¥åœºæ™¯ï¼‰
 * @property {string} raw - åŸå§‹æ¶ˆæ¯ï¼ˆå…œåº•ï¼‰
 * @property {string} [eventName] - Hook äº‹ä»¶å
 * @property {string} [notificationType] - é€šçŸ¥ç±»å‹
 */
```

### å®æ–½æ­¥éª¤

#### 1. ä¿®æ”¹ `notify-system.js`

**ç”Ÿæˆ NotificationPayload**:
```javascript
function createNotificationPayload(hookInput, projectName, taskInfo) {
    const payload = {
        projectName: projectName,
        time: formatTime(new Date()),
        raw: taskInfo,
        eventName: hookInput.hook_event_name,
        notificationType: hookInput.notification_type
    };

    // æ ¹æ® Hook äº‹ä»¶è®¾ç½®çŠ¶æ€
    if (hookInput.hook_event_name === 'Stop') {
        // æ£€æŸ¥æ˜¯å¦ä¸ºå¤±è´¥
        if (isFailureMessage(taskInfo)) {
            payload.status = 'å¤±è´¥';
            payload.error = extractErrorMessage(taskInfo);
        } else {
            payload.status = 'å®Œæˆ';
            payload.summary = taskInfo;
        }
    } else if (hookInput.hook_event_name === 'Notification') {
        payload.status = 'ç­‰å¾…è¾“å…¥';
        payload.summary = hookInput.message || taskInfo;
    }

    return payload;
}
```

**ä¿®å¤ extractTaskSummary() æˆªæ–­é—®é¢˜**:
```javascript
function extractTaskSummary(transcriptPath) {
    // ... è¯»å– transcript ...

    // æ£€æŸ¥æ˜¯å¦ä¸ºå¤±è´¥åœºæ™¯
    if (isFailureMessage(lastMessage)) {
        // å¤±è´¥æ—¶æå–å®Œæ•´é”™è¯¯ä¿¡æ¯ï¼ˆä¸æˆªæ–­ï¼‰
        return extractErrorMessage(lastMessage);
    } else {
        // éå¤±è´¥æ—¶å¯ä»¥æˆªæ–­
        return lastMessage.length > 100
            ? lastMessage.slice(0, 100) + '...'
            : lastMessage;
    }
}

function isFailureMessage(message) {
    const text = message.toLowerCase();
    return text.includes('error') ||
           text.includes('å¤±è´¥') ||
           text.includes('exception') ||
           /http\s*5\d{2}/.test(text);
}

function extractErrorMessage(message) {
    // æå–å…³é”®é”™è¯¯ä¿¡æ¯
    // ä¼˜å…ˆåŒ¹é… HTTP é”™è¯¯ã€Exceptionã€Error ç­‰
    const errorPatterns = [
        /HTTP\s*\d{3}[^]*?(?=\n\n|\n[A-Z]|$)/i,
        /Error:[^]*?(?=\n\n|\n[A-Z]|$)/i,
        /Exception:[^]*?(?=\n\n|\n[A-Z]|$)/i
    ];

    for (const pattern of errorPatterns) {
        const match = message.match(pattern);
        if (match) {
            return match[0].length > 4096
                ? match[0].slice(0, 4096) + '...'
                : match[0];
        }
    }

    // å…œåº•ï¼šè¿”å›å‰ 4096 å­—ç¬¦
    return message.length > 4096
        ? message.slice(0, 4096) + '...'
        : message;
}
```

#### 2. ä¿®æ”¹ `notification-manager.js`

**å‡çº§æ¥å£**:
```javascript
/**
 * å‘é€æ‰€æœ‰å¯ç”¨çš„é€šçŸ¥
 * @param {NotificationPayload|string} payload - é€šçŸ¥è½½è·æˆ–å­—ç¬¦ä¸²
 */
async sendAllNotifications(payload) {
    // å‘åå…¼å®¹ï¼šå­—ç¬¦ä¸²è½¬ä¸º payload
    if (typeof payload === 'string') {
        payload = {
            projectName: this.projectName,
            status: inferStatusFromText(payload),
            time: formatTime(new Date()),
            raw: payload,
            summary: payload
        };
    }

    const notifications = [];

    for (const [type, notifierConfig] of Object.entries(this.notifiers)) {
        if (notifierConfig.enabled) {
            notifications.push(
                this.sendSingleNotification(type, notifierConfig, payload)
            );
        }
    }

    if (notifications.length > 0) {
        const results = await Promise.allSettled(notifications);
        return results;
    }

    return [];
}
```

#### 3. ä¿®æ”¹é€šçŸ¥å™¨æ¥æ”¶ç»“æ„åŒ–æ•°æ®

**feishu-notify.js**:
```javascript
async function notifyTaskCompletion(payload, webhookUrl = null, projectName = "") {
    // å‘åå…¼å®¹
    if (typeof payload === 'string') {
        payload = {
            projectName: projectName,
            status: inferStatusFromText(payload),
            time: formatTime(new Date()),
            raw: payload,
            summary: payload
        };
    }

    const notifier = new FeishuNotifier(webhookUrl || process.env.FEISHU_WEBHOOK_URL);

    const title = `ã€${payload.status}ã€‘${payload.projectName}`;
    let content = `â–  æ—¶é—´ï¼š${payload.time}\n`;

    if (payload.status === 'å¤±è´¥') {
        content += `â–  é”™è¯¯ï¼š${payload.error || payload.raw}`;
    } else if (payload.status === 'ç­‰å¾…è¾“å…¥') {
        content += `â–  åŸå› ï¼šéœ€è¦ä½ çš„è¾“å…¥\n`;
        content += `â–  è¯¦æƒ…ï¼š${payload.summary || payload.raw}`;
    } else {
        content += `â–  çŠ¶æ€ï¼šä»»åŠ¡å·²å®Œæˆ\n`;
        content += `â–  è¯¦æƒ…ï¼š${payload.summary || payload.raw}`;
    }

    return await notifier.sendRichText(title, content);
}
```

**telegram-notify.js**:
```javascript
async function notifyTaskCompletion(payload, projectName = "") {
    // å‘åå…¼å®¹
    if (typeof payload === 'string') {
        payload = {
            projectName: projectName,
            status: inferStatusFromText(payload),
            time: formatTime(new Date()),
            raw: payload,
            summary: payload
        };
    }

    const notifier = new TelegramNotifier();

    const title = `ã€${payload.status}ã€‘${payload.projectName}`;
    let message = `<b>${escapeHtml(title)}</b>\n`;
    message += `â–  æ—¶é—´ï¼š${payload.time}\n`;

    if (payload.status === 'å¤±è´¥') {
        const errorText = escapeHtml(payload.error || payload.raw);
        message += `<b>é”™è¯¯</b>ï¼š${errorText}`;
    } else if (payload.status === 'ç­‰å¾…è¾“å…¥') {
        message += `â–  åŸå› ï¼šéœ€è¦ä½ çš„è¾“å…¥\n`;
        message += `â–  è¯¦æƒ…ï¼š${escapeHtml(payload.summary || payload.raw)}`;
    } else {
        message += `â–  çŠ¶æ€ï¼šä»»åŠ¡å·²å®Œæˆ\n`;
        message += `â–  è¯¦æƒ…ï¼š${escapeHtml(payload.summary || payload.raw)}`;
    }

    // é•¿åº¦é™åˆ¶æ£€æŸ¥
    if (message.length > 4096) {
        message = message.slice(0, 4093) + '...';
    }

    return await notifier.sendMessage(message);
}
```

### éªŒæ”¶æ ‡å‡†

1. çŠ¶æ€è¯†åˆ«å‡†ç¡®ï¼ˆåŸºäº Hook äº‹ä»¶ï¼‰
2. å¤±è´¥æ—¶é”™è¯¯ä¿¡æ¯ä¸æˆªæ–­ï¼ˆæœ€å¤š 4096 å­—ç¬¦ï¼‰
3. ä¸¤ç«¯é€šçŸ¥æ ¼å¼ä¸€è‡´
4. å‘åå…¼å®¹æ—§æ¥å£ï¼ˆå­—ç¬¦ä¸²è¾“å…¥ï¼‰
5. HTML è½¬ä¹‰æ­£ç¡®ï¼Œæ— æ ¼å¼é”™è¯¯
6. é•¿åº¦é™åˆ¶ç”Ÿæ•ˆï¼Œä¸è§¦å‘ Telegram é™åˆ¶

### æµ‹è¯•æ–¹æ³•

```bash
# ä½¿ç”¨ Hook è¾“å…¥æµ‹è¯•
echo '{"hook_event_name":"Stop","message":"ä»»åŠ¡å®Œæˆ"}' | node notify-system.js

# æ¨¡æ‹Ÿå¤±è´¥åœºæ™¯
echo '{"hook_event_name":"Stop","message":"HTTP 502 Bad Gateway: é•¿é”™è¯¯ä¿¡æ¯..."}' | node notify-system.js

# æ¨¡æ‹Ÿç­‰å¾…è¾“å…¥
echo '{"hook_event_name":"Notification","notification_type":"permission_prompt","message":"éœ€è¦ç¡®è®¤æƒé™"}' | node notify-system.js
```

---

## é£é™©æ§åˆ¶

### 1. HTML è½¬ä¹‰é£é™©
**é—®é¢˜**: Telegram æ¶ˆæ¯ä¸­çš„ `<`, `>`, `&` ä¼šå¯¼è‡´æ ¼å¼é”™è¯¯
**è§£å†³**: ä½¿ç”¨ `escapeHtml()` å‡½æ•°è½¬ä¹‰æ‰€æœ‰ç”¨æˆ·è¾“å…¥

### 2. é•¿åº¦é™åˆ¶é£é™©
**é—®é¢˜**: Telegram å•æ¡æ¶ˆæ¯æœ€å¤š 4096 å­—ç¬¦
**è§£å†³**: åœ¨å‘é€å‰æ£€æŸ¥é•¿åº¦ï¼Œè¶…é•¿åˆ™æˆªæ–­å¹¶æ·»åŠ  `...`

### 3. ä¿¡æ¯æ³„éœ²é£é™©
**é—®é¢˜**: é”™è¯¯ä¿¡æ¯å¯èƒ½åŒ…å« tokenã€å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯
**è§£å†³**:
- è¿‡æ»¤å¸¸è§æ•æ„Ÿå­—æ®µï¼ˆ`Authorization:`, `Bearer`, `token=`, `password=`ï¼‰
- åœ¨ README ä¸­æé†’ç”¨æˆ·æ³¨æ„æ•æ„Ÿä¿¡æ¯

### 4. æ—¶åŒºä¸€è‡´æ€§é£é™©
**é—®é¢˜**: é£ä¹¦å’Œ Telegram å½“å‰ä½¿ç”¨ä¸åŒæ—¶åŒº
**è§£å†³**: é˜¶æ®µ 2 ç»Ÿä¸€ä½¿ç”¨æœ¬æœºæ—¶åŒº

### 5. å‘åå…¼å®¹é£é™©
**é—®é¢˜**: ç°æœ‰è°ƒç”¨å¯èƒ½ä¼ å…¥å­—ç¬¦ä¸²
**è§£å†³**: åœ¨æ‰€æœ‰å‡½æ•°ä¸­æ·»åŠ ç±»å‹æ£€æŸ¥å’Œè½¬æ¢é€»è¾‘

---

## å®æ–½æ—¶é—´çº¿

### é˜¶æ®µ 1ï¼ˆé¢„è®¡ 1-2 å°æ—¶ï¼‰
1. æ·»åŠ å·¥å…·å‡½æ•°ï¼ˆ30 åˆ†é’Ÿï¼‰
2. ä¿®æ”¹é£ä¹¦æ¨¡æ¿ï¼ˆ30 åˆ†é’Ÿï¼‰
3. ä¿®æ”¹ Telegram æ¨¡æ¿ï¼ˆ30 åˆ†é’Ÿï¼‰
4. æµ‹è¯•éªŒè¯ï¼ˆ30 åˆ†é’Ÿï¼‰

### é˜¶æ®µ 2ï¼ˆé¢„è®¡ 3-4 å°æ—¶ï¼‰
1. è®¾è®¡æ•°æ®ç»“æ„ï¼ˆ30 åˆ†é’Ÿï¼‰
2. ä¿®æ”¹ notify-system.jsï¼ˆ1 å°æ—¶ï¼‰
3. ä¿®æ”¹ notification-manager.jsï¼ˆ30 åˆ†é’Ÿï¼‰
4. ä¿®æ”¹é€šçŸ¥å™¨ï¼ˆ1 å°æ—¶ï¼‰
5. æµ‹è¯•éªŒè¯ï¼ˆ1 å°æ—¶ï¼‰

---

## æˆåŠŸæ ‡å‡†

### é˜¶æ®µ 1
- âœ… é€šçŸ¥æ ‡é¢˜æ ¼å¼ä¸º `ã€çŠ¶æ€ã€‘é¡¹ç›®å`
- âœ… æ—¶é—´æ ¼å¼ä¸º `MM-DD HH:mm`
- âœ… ä½¿ç”¨çº¯ç¬¦å· `â– ` åˆ†å±‚
- âœ… æ¯æ¡é€šçŸ¥æœ€å¤š 1 ä¸ª emoji
- âœ… é”™è¯¯ä¿¡æ¯åœ¨æ­£æ–‡ä¸­å®Œæ•´æ˜¾ç¤º

### é˜¶æ®µ 2
- âœ… å¼•å…¥ `NotificationPayload` ç»“æ„
- âœ… çŠ¶æ€åŸºäº Hook äº‹ä»¶å‡†ç¡®è¯†åˆ«
- âœ… å¤±è´¥æ—¶é”™è¯¯ä¸æˆªæ–­ï¼ˆæœ€å¤š 4096 å­—ç¬¦ï¼‰
- âœ… ä¸¤ç«¯é€šçŸ¥æ ¼å¼ä¸€è‡´
- âœ… å‘åå…¼å®¹æ—§æ¥å£
- âœ… é€šè¿‡æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹

---

## é™„å½•ï¼šæ¨¡æ¿å¯¹æ¯”

### å½“å‰æ¨¡æ¿
```
ğŸ¤– coriander_player: å·²å®Œæˆ: API Error: 502 {"error":"æ‰€æœ‰ 1 ä¸ª provider å‡å¤±è´¥ï¼Œæœ€åé”™è¯¯: {\"error\":{\"type\":\"\\u003cnil\\u003e\",\"mess...

â° å®Œæˆæ—¶é—´ï¼š2026/1/20 16:11:39

ğŸ’¡ å¯ä»¥æŸ¥çœ‹æ‰§è¡Œç»“æœäº†ï¼
```

### ä¼˜åŒ–åæ¨¡æ¿ï¼ˆé˜¶æ®µ 1ï¼‰
```
ã€å¤±è´¥ã€‘coriander_player
â–  æ—¶é—´ï¼š01-20 16:11
â–  é”™è¯¯ï¼šAPI Error: 502 {"error":"æ‰€æœ‰ 1 ä¸ª provider å‡å¤±è´¥ï¼Œæœ€åé”™è¯¯: {\"error\":{\"type\":\"\\u003cnil\\u003e\",\"message\":\"..."}}}
```

### ä¼˜åŒ–åæ¨¡æ¿ï¼ˆé˜¶æ®µ 2ï¼‰
```
ã€å¤±è´¥ã€‘coriander_player
â–  æ—¶é—´ï¼š01-20 16:11
é”™è¯¯ï¼šHTTP 502 Bad Gateway
æ‰€æœ‰ 1 ä¸ª provider å‡å¤±è´¥
æœ€åé”™è¯¯: {"error":{"type":"<nil>","message":"..."}}
```
